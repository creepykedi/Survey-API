API для приложения с опросами

команда для локального запуска:
manage.py runserver

Инструкция к API
все url указаны без localhost/ в начале

1. Идентификация пользователя, GET
create_person/
создает и возвращает хэш из 12ти цифр для нового пользователя, который потом можно использовать как идентификатор для записи опросов

2. Активные опросы, GET
surveys/active
возвращает JSON активных опросов и их атрибутов(имя, описание, дата начала, дата окончания)

3. Начать опрос, GET
start_survey/<survey_name>/<person_hash>
где survey name — название опроса, person hash — идентификатор пользователя.
Возвращает JSON необходимый фронтэнду чтобы начать опрос: атрибуты опроса, а так же список содержащий:
вопрос,
тип вопроса(1-один вариант ответа, 2-несколько вариантов, 3-ответ текстом),
список вариантов ответа к вопросу

4. Завершенные пользователем опросы, GET
<person_hash>/surveys/completed
возвращает пройденные пользователем опросы

5. Список ответов к пройденному опросу, GET
<person_hash>/surveys/<survey_name>/
возвращает список вопросов и ответов к ним.
Ответы на вопросы типов 1 и 2 попадают в "chosen answer". Ответы в текстовой форме попадают в "given answer".

6. Записать ответ пользователя, POST
<person_hash>/<int:question_id>/<answer>
где question_id - id вопроса, answer - ответ в одном из форматов:
    к вопросам типа 1 принимается id ответа из answeroptions
    к вопросам типа 2 принимаются один или несколько id разделенных &, например 3&9&2
    к типу 3 принимается любой стринг

Возвращает id записанного ответа

пример текстовый ответ:
http://127.0.0.1:8000/461869364870/3/myself
пример ответ из нескольки вариантов:
http://127.0.0.1:8000/461869364870/5/7&8


7. Отметить опрос как пройденый пользователем, GET
<person_hash>/<survey_name>/complete
Отсылается по завершению опроса пользователем

пример:
http://127.0.0.1:8000/461869364870/USA Politics/complete

Изменение и добавление опросов

Администратор может изменять и добавлять опросы через django admin авторизовавшись по url "/admin":
login: Admin
pass: strongpassword

Как создать опрос:
создаем опрос в Surveys(название, описание, даты)
создаем вопросы в Questions(вопрос, тип). Там же привязываем вопрос к опросу(survey).
Опционально создаем варианты ответов в Answer Options, и привязываем их через questions(поле answer options, может быть несколько)


Так же их можно менять через API используя токен админа. Для этого к каждому из следующих запросов надо добавить хедер(без кавычек):
Key: "Authorization"
Value: "TOKEN 72df72413b44119baa1b8a947423458d27f0c3c2"
если не добавить, ответ будет 401

1. Создать опрос, POST
surveys/create_survey/<survey_name>&<description>
где survey name — название опроса, description — описание. Даты по умолчанию заполняются null. Возвращает атрибуты созданного опроса

пример:
http://127.0.0.1:8000/surveys/create_survey/foreign languages&language proficiency survey

2. Назначить даты опроса, PUT
surveys/set_survey_date/<survey_name>/<start>&<end>

где start - дата начала опроса в формате ГГГГ-ММ-ДД
end - дата конца опроса в том же формате
start и end могут принимать параметр now, который поставит текущую дату/время

пример:
http://127.0.0.1:8000/surveys/set_survey_date/foreign languages/now&2020-08-10

3.Изменить название/описание опроса, PUT

update_survey/<survey_name>&<new_name>&<new_desc>
где new_name - новое имя, new_desc - новое описание

Возможно, только если опрос еще не начался(иначе 403/no permission).

пример:
http://127.0.0.1:8000/update_survey/foreign languages&updated survey&updated

4. Добавить вопрос, POST
surveys/<survey_name>/add/<question_text>&<type>/
question_text - Текст вопроса, type - тип в виде цифры 1, 2 или 3

пример:
http://127.0.0.1:8000/surveys/foreign languages/add/Do you speak any foreign languages&2/

5. Удалить опрос, DELETE
surveys/delete/<survey_name>

пример:
http://127.0.0.1:8000/surveys/delete/foreign languages
